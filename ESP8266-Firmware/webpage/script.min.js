var content="Content-type";var cache="cache-control";var priv="private";var ctype="application/x-www-form-urlencoded";var cjson="application/json";function reloadAfter(a){setTimeout(function(){window.location.replace("/")},a*1000)}function onRangeChange(e,b,d,a){var c=document.getElementById(e).value;if(a){c=document.getElementById(e).max-c}document.getElementById(b).innerHTML=(c*d)+" dB";saveSoundSettings()}function onRangeChangeFreqTreble(e,b,d,a){var c=document.getElementById(e).value;if(a){c=document.getElementById(e).max-c}document.getElementById(b).innerHTML="From "+(c*d)+" kHz";saveSoundSettings()}function onRangeChangeFreqBass(e,b,d,a){var c=document.getElementById(e).value;if(a){c=document.getElementById(e).max-c}document.getElementById(b).innerHTML="Under "+(c*d)+" Hz";saveSoundSettings()}function onRangeChangeSpatial(d,b){var c=document.getElementById(d).value;var a;switch(c){case"0":a="Off";break;case"1":a="Minimal";break;case"2":a="Normal";break;case"3":a="Maximal";break}document.getElementById(b).innerHTML=a;saveSoundSettings()}function onRangeVolChange(a){var b=document.getElementById("vol_range").max-a;document.getElementById("vol1_span").innerHTML=(b*-0.5)+" dB";document.getElementById("vol_span").innerHTML=(b*-0.5)+" dB";document.getElementById("vol_range").value=a;document.getElementById("vol1_range").value=a;xhr=new XMLHttpRequest();xhr.open("POST","soundvol",false);xhr.setRequestHeader(content,ctype);xhr.send("vol="+document.getElementById("vol_range").value+"&")}function instantPlay(){xhr=new XMLHttpRequest();xhr.open("POST","instant_play",false);xhr.setRequestHeader(content,ctype);xhr.setRequestHeader(cache,priv);if(!(document.getElementById("instant_path").value.substring(0,1)==="/")){document.getElementById("instant_path").value="/"+document.getElementById("instant_path").value}document.getElementById("instant_url").value=document.getElementById("instant_url").value.replace(/^https?:\/\//,"");xhr.send("url="+document.getElementById("instant_url").value+"&port="+document.getElementById("instant_port").value+"&path="+document.getElementById("instant_path").value+"&");window.location.replace("/")}function playStation(){select=document.getElementById("stationsSelect");localStorage.setItem("selindexstore",select.options.selectedIndex.toString());xhr=new XMLHttpRequest();xhr.open("POST","play",false);xhr.setRequestHeader(content,ctype);xhr.setRequestHeader(cache,priv);xhr.send("id="+select.options[select.options.selectedIndex].id+"&");window.location.replace("/")}function stopStation(){var a=document.getElementById("stationsSelect");localStorage.setItem("selindexstore",a.options.selectedIndex.toString());xhr=new XMLHttpRequest();xhr.open("POST","stop",false);xhr.setRequestHeader(content,ctype);xhr.setRequestHeader(cache,priv);xhr.send("id="+a.options[a.options.selectedIndex].id+"&");window.location.replace("/")}function saveSoundSettings(){xhr=new XMLHttpRequest();xhr.open("POST","sound",false);xhr.setRequestHeader(content,ctype);xhr.setRequestHeader(cache,priv);xhr.send("&bass="+document.getElementById("bass_range").value+"&treble="+document.getElementById("treble_range").value+"&bassfreq="+document.getElementById("bassfreq_range").value+"&treblefreq="+document.getElementById("treblefreq_range").value+"&spacial="+document.getElementById("spacial_range").value+"&")}function saveStation(){var b=document.getElementById("add_path").value;var a=document.getElementById("add_url").value;if(!(b.substring(0,1)==="/")){b="/"+b}a=a.replace(/^https?:\/\//,"");xhr=new XMLHttpRequest();xhr.open("POST","setStation",false);xhr.setRequestHeader(content,ctype);xhr.setRequestHeader(cache,priv);xhr.send("id="+document.getElementById("add_slot").value+"&url="+a+"&name="+document.getElementById("add_name").value+"&file="+b+"&port="+document.getElementById("add_port").value+"&");sessionStorage.setItem(document.getElementById("add_slot").value,'{"Name":"'+document.getElementById("add_name").value+'","URL":"'+a+'","File":"'+b+'","Port":"'+document.getElementById("add_port").value+'"}');window.location.reload(false)}function editStation(c){function b(){document.getElementById("add_url").value=a.URL;document.getElementById("add_name").value=a.Name;document.getElementById("add_path").value=a.File;document.getElementById("add_port").value=a.Port;document.getElementById("editStationDiv").style.display="block";setMainHeight("tab-content2")}document.getElementById("add_slot").value=c;idstr=c.toString();if(sessionStorage.getItem(idstr)!=null){var a=JSON.parse(sessionStorage.getItem(idstr));b()}else{xhr=new XMLHttpRequest();xhr.onreadystatechange=function(){if(xhr.readyState==4&&xhr.status==200){var d=JSON.parse(xhr.responseText);b()}};xhr.open("POST","getStation",false);xhr.setRequestHeader(content,ctype);xhr.setRequestHeader(cache,priv);xhr.send("idgp="+c+"&")}}function loadStations(d){var b=document.createElement("tbody");var f=16*(d-1);function c(k,g){var i=document.createElement("TR");var j=document.createElement("TD");j.appendChild(document.createTextNode(k+1));j.style.width="10%";i.appendChild(j);for(var h in g){var j=document.createElement("TD");if(g[h].length>64){g[h]="Error"}j.appendChild(document.createTextNode(g[h]));i.appendChild(j)}var j=document.createElement("TD");j.innerHTML='<a href="#" onClick="editStation('+k+')">Edit</a>';i.appendChild(j);b.appendChild(i)}for(f;f<16*d;f++){idstr=f.toString();if(sessionStorage.getItem(idstr)!=null){var a=JSON.parse(sessionStorage.getItem(idstr));c(f,a)}else{xhr=new XMLHttpRequest();xhr.onreadystatechange=function(){if(xhr.readyState==4&&xhr.status==200){var g=JSON.parse(xhr.responseText);sessionStorage.setItem(idstr,xhr.responseText);c(f,g)}};xhr.open("POST","getStation",false);xhr.setRequestHeader(content,ctype);xhr.send("idgp="+f+"&")}}var e=document.getElementById("stationsTable").getElementsByTagName("tbody")[0];e.parentNode.replaceChild(b,e);setMainHeight("tab-content2")}function loadStationsList(b){var d=false;function c(i,f){var h=false;if(f.Name.length>0){var g=document.createElement("option");g.appendChild(document.createTextNode(f.Name));g.id=i;document.getElementById("stationsSelect").appendChild(g)}else{h=true}return h}document.getElementById("stationsSelect").disabled=true;for(var e=0;e<b;e++){if(d){break}idstr=e.toString();if(sessionStorage.getItem(idstr)!=null){var a=JSON.parse(sessionStorage.getItem(idstr));d=c(e,a)}else{xhr=new XMLHttpRequest();xhr.onreadystatechange=function(){if(xhr.readyState==4&&xhr.status==200){var f=JSON.parse(xhr.responseText);sessionStorage.setItem(idstr,xhr.responseText);d=c(e,f)}};xhr.open("POST","getStation",false);xhr.setRequestHeader(content,ctype);xhr.send("idgp="+e+"&")}}document.getElementById("stationsSelect").disabled=false;select=document.getElementById("stationsSelect");select.options.selectedIndex=parseInt(localStorage.getItem("selindexstore"))}function setMainHeight(a){var c=window.innerHeight;var b=document.getElementById(a).offsetHeight+200;if(b<c){b=c}document.getElementById("MAIN").style.height=b}document.addEventListener("DOMContentLoaded",function(){document.getElementById("tab1").addEventListener("click",function(){setMainHeight("tab-content1")});document.getElementById("tab2").addEventListener("click",function(){loadStations(1);setMainHeight("tab-content2")});document.getElementById("tab3").addEventListener("click",function(){setMainHeight("tab-content3")});onRangeChange("treble_range","treble_span",1.5,false);onRangeChange("bass_range","bass_span",1,false);onRangeChangeFreqTreble("treblefreq_range","treblefreq_span",1,false);onRangeChangeFreqBass("bassfreq_range","bassfreq_span",10,false);onRangeChangeSpatial("spacial_range","spacial_span");onRangeChange("vol_range","vol1_span",-0.5,true);onRangeChange("vol_range","vol_span",-0.5,true);loadStationsList(192);onRangeChange("vol1_range","vol1_span",-0.5,true);setMainHeight("tab-content1")});